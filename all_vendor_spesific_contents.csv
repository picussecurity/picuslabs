sigma_id;sigma_title;Splunk;QRadar;ArcSight
3124;Script File Execution via WScript or CScript Tool;"(source=""WinEventLog:Security"" EventCode=""4688"" (New_Process_Name=""*\\cscript.exe"" OR New_Process_Name=""*\\wscript.exe"") (Process_Command_Line=""*.vbs*"" OR Process_Command_Line=""*.js*"" OR Process_Command_Line=""*//E:jscript*"" OR Process_Command_Line=""*//E:vbscript*""))";"(LOGSOURCETYPENAME(devicetype)='Microsoft Windows Security Event Log' and EventID='4688' and (Image ilike '%\cscript.exe' or Image ilike '%\wscript.exe') and (""Process CommandLine"" ilike '%.vbs%' or ""Process CommandLine"" ilike '%.js%' or ""Process CommandLine"" ilike '%//E:jscript%' or ""Process CommandLine"" ilike '%//E:vbscript%'))";"(deviceVendor = ""Microsoft"" AND deviceProduct = ""Microsoft Windows"" AND externalId = ""4688"" AND (destinationProcessName ENDSWITH ""cscript.exe"" OR destinationProcessName ENDSWITH ""wscript.exe"") AND (deviceCustomString4 CONTAINS "".vbs"" OR deviceCustomString4 CONTAINS "".js"" OR deviceCustomString4 CONTAINS ""//E:jscript"" OR deviceCustomString4 CONTAINS ""//E:vbscript""))"
8834;Persistence by Adding a User to Local Administrator Group;"(source=""WinEventLog:Security"" EventCode=""4732"" (Group_Name=""Administrators"" OR Security_ID=""S-1-5-32-544""))";(LOGSOURCETYPENAME(devicetype)='Microsoft Windows Security Event Log' and EventID='4732' and (GroupName='Administrators' or SecurityID='S-1-5-32-544'));"(deviceVendor = ""Microsoft"" AND deviceProduct = ""Microsoft Windows"" AND externalId = ""4732"" AND (deviceCustomString1 = ""Administrators"" OR deviceCustomString1 = ""S-1-5-32-544""))"
8694;TCP Connection Creating via PowerShell Script;"(source=""WinEventLog:Microsoft-Windows-PowerShell/Operational"" EventCode=""4104"" (Message=""*Net.Sockets.TcpClient(*, *)*"" OR Message=""*Net.Sockets.TcpListener(*, *)*""))";(LOGSOURCETYPENAME(devicetype)='Microsoft Windows Security Event Log' and EventID='4104' and (Message ilike '%Net.Sockets.TcpClient(%, %)%' or Message ilike '%Net.Sockets.TcpListener(%, %)%'));"(deviceVendor=""Microsoft"" AND deviceProduct=""PowerShell"" AND externalId=""4104"" AND (message CONTAINS ""Net.Sockets.TcpClient"" OR message CONTAINS ""Net.Sockets.TcpListener""))"
7402;Pass the Key with Rubeus;"(source=""WinEventLog:Security"" EventCode=""4688"" (Process_Command_Line=""* asktgt */user:* /ptt*""))";"(LOGSOURCETYPENAME(devicetype)='Microsoft Windows Security Event Log' and EventID='4688' and (""Process CommandLine"" ilike '% asktgt %/user:% /ptt%'))";"(deviceVendor=""Microsoft"" AND deviceProduct=""Microsoft Windows"" AND externalId=""4688"" AND (deviceCustomString4 CONTAINS ""asktgt"" AND deviceCustomString4 CONTAINS ""/user:"" AND deviceCustomString4 CONTAINS "" /ptt""))"
6769;Suspicious RC4 Encrypted Kerberos Service Ticket Request;"(source=""WinEventLog:Security"" (EventCode=""4769"" Ticket_Encryption_Type=""0x17"" Ticket_Options=""0x40810000"" Failure_Code=""0x0"") NOT ((Service_Name=""*$"" OR Service_Name=""krbtgt"") Account_Name=""*$@*""))";"(LOGSOURCETYPENAME(devicetype)='Microsoft Windows Security Event Log' and (EventID='4769' and ""Ticket Encryption Type""='0x17' and ""Ticket Options""='0x40810000' and ""Failure Code""='0x0') and not ((""Service Name"" ilike '%$' or ""Service Name"" = 'krbtgt') and AccountName ilike '%$@%'))";"(deviceVendor=""Microsoft"" AND deviceProduct=""Microsoft Windows"" AND (externalId=""4769"" AND deviceCustomString1=""0x17"" AND deviceCustomString1=""0x40810000"" AND deviceCustomString1=""0x0"") AND NOT ((destinationServiceName=""$"" OR destinationServiceName=""krbtgt"") AND deviceCustomString1=""$@""))"
5629;Kerberoasting with Rubeus;"(source=""WinEventLog:Security"" EventCode=""4688"" (Process_Command_Line=""*kerberoast*""))";"(LOGSOURCETYPENAME(devicetype)='Microsoft Windows Security Event Log' and EventID='4688' and (""Process CommandLine"" ilike '%kerberoast%'))";"(deviceVendor = ""Microsoft"" AND deviceProduct = ""Microsoft Windows"" AND externalId = ""4688"" AND deviceCustomString4 CONTAINS ""kerberoast"")"
4654;Code Execution via Microsoft Build Engine ;"(source=""WinEventLog:Security"" EventCode=""4688"" New_Process_Name=""*\\MsBuild.exe"")";(LOGSOURCETYPENAME(devicetype)='Microsoft Windows Security Event Log' and EventID='4688' and Image ilike '%\MsBuild.exe');"(deviceVendor=""Microsoft"" AND deviceProduct=""Microsoft Windows"" AND externalId=""4688"" AND destinationProcessName CONTAINS ""MSBuild.exe"")"
4615;Suspicious Credential Vault Client Library Load;"(source=""WinEventLog:Microsoft-Windows-Sysmon/Operational"" (EventCode=""7"" ImageLoaded=""*\\vaultcli.dll"") NOT ((Image=""*\\vaultcmd.exe"" OR Image=""*\\explorer.exe"")))";(LOGSOURCETYPENAME(devicetype)='Microsoft Windows Security Event Log' and (EventID='7' and ImageLoaded ilike '%\vaultcli.dll') and not ((Image ilike '%\vaultcmd.exe' or Image ilike '%\explorer.exe')));"(deviceVendor=""Microsoft"" AND deviceProduct=""Sysmon"" AND (externalId=""7"" AND fileName ENDSWITH ""vaultcli.dll"") AND NOT ((destinationProcessName CONTAINS ""vaultcmd.exe"" OR destinationProcessName CONTAINS ""explorer.exe"")))"
6516; Execution Through Module Load via PowerShell;"(source=""WinEventLog:Microsoft-Windows-PowerShell/Operational"" (EventCode=""4104"" OR EventCode=""4103"") Message=""*Reflection*"" Message=""*Assembly*"" Message=""*Load*"")";(LOGSOURCETYPENAME(devicetype)='Microsoft Windows Security Event Log' and (EventID = '4104' or EventID = '4103') and Message ilike '%Reflection%' and Message ilike '%Assembly%' and Message ilike '%Load%');"(deviceVendor=""Microsoft"" AND deviceProduct=""PowerShell"" AND (externalId=""4104"" OR externalId=""4103"") AND message CONTAINS ""Reflection"" AND message CONTAINS ""Assembly"" AND message CONTAINS ""Load"")"
4737;Symmetric Cryptography Encryptor and Decryptor Utilization via PowerShell;"(source=""WinEventLog:Microsoft-Windows-PowerShell/Operational"" (EventCode=""4103"" OR EventCode=""4104"") Message=""*Security*"" Message=""*Cryptography*"" (Message=""*CreateDecryptor*"" OR Message=""*CreateEncryptor*""))";(LOGSOURCETYPENAME(devicetype)='Microsoft Windows Security Event Log' and (EventID = '4103' or EventID = '4104') and Message ilike '%Security%' and Message ilike '%Cryptography%' and (Message ilike '%CreateDecryptor%' or Message ilike '%CreateEncryptor%'));"(deviceVendor=""Microsoft"" AND deviceProduct=""PowerShell"" AND (externalId=""4103"" OR externalId=""4104"") AND message CONTAINS ""Security"" AND message CONTAINS ""Cryptography"" AND (message CONTAINS ""CreateDecryptor"" OR message CONTAINS ""CreateEncryptor""))"
3707;Execution of C# Compiler;"(source=""WinEventLog:Security"" EventCode=""4688"" New_Process_Name=""*\\csc.exe"")";(LOGSOURCETYPENAME(devicetype)='Microsoft Windows Security Event Log' and EventID='4688' and Image ilike '%\csc.exe');"(deviceVendor=""Microsoft"" AND deviceProduct=""Microsoft Windows"" AND externalId=""4688"" AND destinationProcessName ENDSWITH ""csc.exe"")"
4155;Suspicious DISM Core Framework Portable Executable Load;"(source=""WinEventLog:Microsoft-Windows-Sysmon/Operational"" (EventCode=""7"" (ImageLoaded=""*\\DismCore.dll"")) NOT ((ImageLoaded=""*C:\\Windows\\System32\\Dism\\DismCore.dll*"" OR ImageLoaded=""*C:\\Windows\\SysWOW64\\Dism\\DismCore.dll*"")))";(LOGSOURCETYPENAME(devicetype)='Microsoft Windows Security Event Log' and (EventID='7' and (LoadedImage ilike '%\DismCore.dll')) and not ((LoadedImage ilike '%C:\Windows\System32\Dism\DismCore.dll%' or LoadedImage ilike '%C:\Windows\SysWOW64\Dism\DismCore.dll%')));"(deviceVendor=""Microsoft"" AND deviceProduct=""Sysmon"" AND (externalId=""7"" AND (fileName ENDSWITH ""DismCore.dll"")) AND NOT ((fileName=""C:\\Windows\\System32\\Dism\\DismCore.dll"" OR fileName=""C:\\Windows\\SysWOW64\\Dism\\DismCore.dll"")))"